{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "ffmpeg-log",
	"scopeName": "source.ffmpeg-log",
	"patterns": [
		{ "include": "#banner-line" },
		{ "include": "#input-output-line" },
		{ "include": "#stream-mapping-header" },
		{ "include": "#stream-mapping-line" },
		{ "include": "#stream-line" },
		{ "include": "#metadata-header" },
		{ "include": "#metadata-kv-line" },
		{ "include": "#progress-line" },
		{ "include": "#module-prefix-line" },
		{ "include": "#control-hints" },
		{ "include": "#severity" },
		{ "include": "#time-and-duration" },
		{ "include": "#rates-units" },
		{ "include": "#resolution" },
		{ "include": "#aspect" },
		{ "include": "#codecs" },
		{ "include": "#pix-fmts" },
		{ "include": "#colors" },
		{ "include": "#container-formats" },
		{ "include": "#stream-disposition" },
		{ "include": "#flags" },
		{ "include": "#paths-urls" },
		{ "include": "#hex" },
		{ "include": "#quoted" },
		{ "include": "#fallback-kv" },
		{ "include": "#percent" },
		{ "include": "#numbers-soft" }
	],
	"repository": {
		"progress-line": {
			"name": "meta.progress.ffmpeg-log",
			"begin": "^(?=\\s*(?:frame|fps|q|L?size|time|bitrate|speed|dup|drop|total_size|out_time|out_time_ms|progress|stream_\\d+_\\d+_(?:q|fps))\\s*=)",
			"end": "$",
			"patterns": [
				{
					"match": "\\b(?:frame|fps|q|L?size|time|bitrate|speed|dup|drop|total_size|out_time|out_time_ms|progress|stream_\\d+_\\d+_(?:q|fps))\\b(?=\\s*=)",
					"name": "variable.other.progress-key.ffmpeg-log"
				},
				{ "match": "=", "name": "keyword.operator.assignment.ffmpeg-log" },
				{ "include": "#time-and-duration" },
				{ "include": "#rates-units" },
				{ "include": "#severity" },
				{ "include": "#percent" },
				{ "include": "#numbers-soft" }
			]
		},

		"module-prefix-line": {
			"name": "meta.module-prefix.ffmpeg-log",
			"begin": "^(\\s*)(\\[[^\\]]+\\])",
			"beginCaptures": {
				"2": { "name": "entity.name.tag.module.ffmpeg-log" }
			},
			"end": "$",
			"patterns": [
				{ "include": "#severity" },
				{ "include": "#time-and-duration" },
				{ "include": "#rates-units" },
				{ "include": "#codecs" },
				{ "include": "#pix-fmts" },
				{ "include": "#colors" },
				{ "include": "#flags" },
				{ "include": "#paths-urls" },
				{ "include": "#hex" },
				{ "include": "#quoted" },
				{ "include": "#percent" },
				{ "include": "#fallback-kv" },
				{ "include": "#numbers-soft" }
			]
		},

		"input-output-line": {
			"name": "meta.io.ffmpeg-log",
			"begin": "^\\s*(Input|Output)\\s+#(\\d+),\\s*",
			"beginCaptures": {
				"1": { "name": "keyword.control.io-kind.ffmpeg-log" },
				"2": { "name": "constant.numeric.io-index.ffmpeg-log" }
			},
			"end": "$",
			"patterns": [
				{ "match": "\\b(?:from|to)\\b", "name": "keyword.operator.io-direction.ffmpeg-log" },
				{ "include": "#container-formats" },
				{ "include": "#paths-urls" },
				{ "include": "#quoted" },
				{ "include": "#time-and-duration" },
				{ "include": "#rates-units" },
				{ "include": "#resolution" },
				{ "include": "#aspect" },
				{ "include": "#codecs" },
				{ "include": "#pix-fmts" },
				{ "include": "#colors" },
				{ "include": "#stream-disposition" },
				{ "include": "#flags" },
				{ "include": "#hex" },
				{ "include": "#percent" },
				{ "include": "#numbers-soft" }
			]
		},

		"stream-line": {
			"name": "meta.stream.ffmpeg-log",
			"begin": "^\\s*(Stream\\s+#\\d+:\\d+(?:\\[[^\\]]+\\])?(?:\\([^\\)]+\\))?:)",
			"beginCaptures": {
				"1": { "name": "constant.language.stream-id.ffmpeg-log" }
			},
			"end": "$",
			"patterns": [
				{
					"match": "\\b(Video|Audio|Subtitle|Data|Attachment)\\b",
					"name": "storage.type.stream-kind.ffmpeg-log"
				},
				{ "include": "#codecs" },
				{ "include": "#pix-fmts" },
				{ "include": "#resolution" },
				{ "include": "#rates-units" },
				{ "include": "#time-and-duration" },
				{ "include": "#colors" },
				{ "include": "#aspect" },
				{ "include": "#stream-disposition" },
				{ "include": "#container-formats" },
				{ "include": "#severity" },
				{ "include": "#hex" },
				{ "include": "#quoted" },
				{ "include": "#percent" }
			]
		},

		"stream-mapping-header": {
			"patterns": [
				{
					"match": "^\\s*Stream mapping:\\s*$",
					"name": "entity.name.section.mapping.ffmpeg-log"
				}
			]
		},

		"stream-mapping-line": {
			"name": "meta.mapping.ffmpeg-log",
			"begin": "^\\s*(?=Stream\\s+#\\d+:\\d+(?:\\[[^\\]]+\\])?(?:\\([^\\)]+\\))?\\s*(?:->|→)\\s*#\\d+:\\d+(?:\\[[^\\]]+\\])?(?:\\([^\\)]+\\))?)",
			"end": "$",
			"patterns": [
				{
					"match": "\\bStream\\s+#\\d+:\\d+(?:\\[[^\\]]+\\])?(?:\\([^\\)]+\\))?(?=\\s|$)|#\\d+:\\d+(?:\\[[^\\]]+\\])?(?:\\([^\\)]+\\))?(?=\\s|$)",
					"name": "constant.language.stream-id.ffmpeg-log"
				},
				{ "match": "->|→", "name": "punctuation.separator.mapping.ffmpeg-log" },
				{ "include": "#codecs" },
				{ "include": "#severity" },
				{ "include": "#quoted" },
				{ "include": "#percent" },
				{ "include": "#numbers-soft" }
			]
		},

		"metadata-header": {
			"patterns": [
				{ "match": "^\\s*Metadata:\\s*$", "name": "entity.name.section.metadata.ffmpeg-log" },
				{ "match": "^\\s*Side data:\\s*$", "name": "entity.name.section.metadata.ffmpeg-log" }
			]
		},

		"metadata-kv-line": {
			"begin": "^\\s{2,}([A-Za-z_][\\w.-]*)\\s*(:)\\s*",
			"beginCaptures": {
				"1": { "name": "variable.other.metadata-key.ffmpeg-log" },
				"2": { "name": "punctuation.separator.key-value.ffmpeg-log" }
			},
			"end": "$",
			"patterns": [
				{ "include": "#time-and-duration" },
				{ "include": "#rates-units" },
				{ "include": "#resolution" },
				{ "include": "#aspect" },
				{ "include": "#codecs" },
				{ "include": "#pix-fmts" },
				{ "include": "#colors" },
				{ "include": "#container-formats" },
				{ "include": "#stream-disposition" },
				{ "include": "#flags" },
				{ "include": "#paths-urls" },
				{ "include": "#hex" },
				{ "include": "#quoted" },
				{ "include": "#severity" },
				{ "include": "#percent" },
				{ "include": "#numbers-soft" }
			]
		},

		"banner-line": {
			"patterns": [
				{
					"match": "^\\s*ff(?:mpeg|probe) version\\b.*$",
					"name": "entity.name.section.banner.ffmpeg-log"
				},
				{
					"match": "^\\s*(configuration|built with|libavutil|libavcodec|libavformat|libavdevice|libavfilter|libswscale|libswresample|libpostproc)\\b.*$",
					"name": "support.function.library.ffmpeg-log"
				},
				{
					"match": "\\b(Lavf|Lavc|Lavu|Lavs)\\d+(?:\\.\\d+){1,3}\\b",
					"name": "support.constant.version.ffmpeg-log"
				}
			]
		},

		"control-hints": {
			"patterns": [
				{
					"match": "^\\s*Press\\s+\\[q\\]\\s+to\\s+stop\\b.*$",
					"name": "meta.prompt.control.ffmpeg-log"
				},
				{
					"match": "\\[(?:q|\\?)\\]",
					"name": "constant.character.escape.control.ffmpeg-log"
				}
			]
		},

		"severity": {
			"patterns": [
				{
					"match": "\\b(?:[Ee]rror|[Ff]atal|[Ff]ailed|[Ff]ailure|[Ii]nvalid|[Cc]annot|[Uu]nable|[Nn]ot\\s+[Ff]ound|[Nn]o\\s+[Ss]uch\\s+[Ff]ile|[Pp]ermission\\s+[Dd]enied|[Cc]onversion\\s+[Ff]ailed)\\b",
					"name": "invalid.illegal.ffmpeg-log"
				},
				{
					"match": "\\b(?:[Ww]arning|[Dd]eprecated|[Oo]verflow|[Nn]on-monotonous|[Uu]nstable)\\b",
					"name": "markup.changed.warning.ffmpeg-log"
				}
			]
		},

		"time-and-duration": {
			"patterns": [
				{
					"match": "\\bDuration\\s*:\\s*(?:N\\/A|\\d{1,2}:\\d{2}:\\d{2}(?:[\\.,]\\d+)?)\\b",
					"name": "constant.numeric.duration.ffmpeg-log"
				},
				{
					"match": "\\b\\d{4}-\\d{2}-\\d{2}[ T]\\d{2}:\\d{2}:\\d{2}(?:[\\.,]\\d+)?(?:Z|[+-]\\d{2}:?\\d{2})?\\b",
					"name": "constant.numeric.timestamp.ffmpeg-log"
				},
				{
					"match": "\\b\\d{4}-\\d{2}-\\d{2}\\b|\\b\\d{1,2}-\\d{1,2}-\\d{4}\\b",
					"name": "constant.other.date.ffmpeg-log"
				},
				{
					"match": "\\b\\d{1,2}:\\d{2}:\\d{2}(?:[\\.,]\\d+)?\\b",
					"name": "constant.numeric.time.ffmpeg-log"
				},
				{
					"match": "\\b(?:start|pts(?:_time)?|dts(?:_time)?|duration|delay)\\s*[:=]\\s*-?\\d+(?:\\.\\d+)?\\b",
					"name": "constant.numeric.time-value.ffmpeg-log"
				},
				{
					"match": "\\bN\\/A\\b",
					"name": "constant.language.na.ffmpeg-log"
				}
			]
		},

		"rates-units": {
			"patterns": [
				{
					"match": "\\b(?:\\d+(?:\\.\\d+)?\\s*fps|\\d+(?:\\.\\d+)?(?:[kKmMgG])?\\s*(?:tbr|tbn|tbc))\\b",
					"name": "constant.numeric.rate.ffmpeg-log"
				},
				{
					"match": "\\b\\d+(?:\\.\\d+)?\\s*(?:Hz|kHz|MHz)\\b",
					"name": "constant.numeric.frequency.ffmpeg-log"
				},
				{
					"match": "\\b\\d+(?:\\.\\d+)?\\s*(?:bits?\\/s|kbits?\\/s|Mbits?\\/s|Gbits?\\/s|bit\\/s|kbit\\/s|Mbit\\/s|Gbit\\/s|kb\\/s|Mb\\/s|Gb\\/s)\\b",
					"name": "constant.numeric.bitrate.ffmpeg-log"
				},
				{
					"match": "\\b\\d+(?:\\.\\d+)?\\s*(?:B|kB|MB|GB|TB|KiB|MiB|GiB|TiB)\\b",
					"name": "constant.numeric.size.ffmpeg-log"
				},
				{
					"match": "\\b\\d+(?:\\.\\d+)?x\\b",
					"name": "constant.numeric.speed.ffmpeg-log"
				}
			]
		},

		"resolution": {
			"match": "\\b\\d{2,5}x\\d{2,5}(?:i|p)?\\b",
			"name": "constant.numeric.resolution.ffmpeg-log"
		},

		"codecs": {
			"match": "\\b(?:h264|h265|hevc|av1|vp9|vp8|mpeg2video|mpeg4|prores|dnxhd|rawvideo|theora|mjpeg|png|gif|aac|ac3|eac3|mp2|mp3|opus|vorbis|flac|alac|truehd|dts(?:-hd)?|pcm_[a-z0-9]+|copy|libx264|libx265|libaom-av1|librav1e|libsvtav1|libvpx(?:-vp9)?|h264_nvenc|hevc_nvenc|av1_nvenc|h264_qsv|hevc_qsv|av1_qsv|h264_videotoolbox|hevc_videotoolbox|av1_videotoolbox)\\b",
			"name": "support.type.codec.ffmpeg-log"
		},

		"pix-fmts": {
			"match": "\\b(?:yuv[aj]?\\d{3}p(?:10|12|14|16)?(?:le|be)?|yuva\\d{3}p(?:10|12|16)?(?:le|be)?|nv12|nv16|nv21|p010(?:le|be)|p016(?:le|be)|rgb24|bgr24|rgba|bgra|argb|abgr|gbrp(?:10|12|14|16)?(?:le|be)?|gray(?:8|10|12|14|16)?(?:le|be)?|fltp|u8p?|s16(?:le|be)?|s24(?:le|be)?|s32(?:le|be)?)\\b",
			"name": "constant.language.pixel-format.ffmpeg-log"
		},

		"colors": {
			"patterns": [
				{
					"match": "\\b(?:bt709|bt2020|bt601|smpte170m|smpte240m|bt470bg|bt470m|smpte2084|arib-std-b67|iec61966-2-1|unknown)\\b",
					"name": "constant.language.colorspace.ffmpeg-log"
				},
				{
					"match": "\\b(tv|pc|limited|full|progressive|interlaced)\\b",
					"name": "constant.language.color-range.ffmpeg-log"
				},
				{
					"match": "\\b(8-bit|10-bit|12-bit|16-bit)\\b",
					"name": "constant.language.bitdepth.ffmpeg-log"
				},
				{
					"match": "\\b(4:2:0|4:2:2|4:4:4|4:1:1|4:0:0)\\b",
					"name": "constant.language.chroma.ffmpeg-log"
				}
			]
		},

		"aspect": {
			"match": "\\b(?:SAR|DAR|PAR)\\s+\\d+:\\d+\\b",
			"name": "constant.language.aspect-ratio.ffmpeg-log"
		},

		"container-formats": {
			"match": "\\b(?:mp4|mov|m4a|3gp|3g2|mj2|matroska|mkv|webm|avi|flv|mpegts|ts|m2ts|ogg|wav|aiff|flac|mp3|hls|dash|image2|segment|concat|nut|srt|ass)\\b",
			"name": "entity.name.type.container.ffmpeg-log"
		},

		"stream-disposition": {
			"match": "\\((?:default|forced|dub|original|comment|lyrics|karaoke|hearing impaired|visual impaired|captions|descriptions|clean effects|attached pic|timed thumbnails)\\)",
			"name": "keyword.control.disposition.ffmpeg-log"
		},

		"flags": {
			"patterns": [
				{
					"match": "(?<!\\w)-[a-zA-Z][a-zA-Z0-9_-]*(?::[a-zA-Z0-9_]+)+\\b",
					"name": "support.constant.flag.specifier.ffmpeg-log"
				},
				{
					"match": "(?<!\\w)--[a-zA-Z][a-zA-Z0-9-]*\\b",
					"name": "support.constant.flag.long.ffmpeg-log"
				},
				{
					"match": "(?<!\\w)-[a-zA-Z][a-zA-Z0-9_-]{1,}\\b",
					"name": "support.constant.flag.long.ffmpeg-log"
				},
				{
					"match": "(?<!\\w)-[a-zA-Z](?:\\:[a-zA-Z0-9_]+)?\\b",
					"name": "support.constant.flag.short.ffmpeg-log"
				}
			]
		},

		"paths-urls": {
			"patterns": [
				{
					"match": "\\b(?:https?|file|ftp|rtsp|rtmp|rtmps|udp|tcp|srt)://[^\\s'\"<>]+",
					"name": "markup.underline.link.ffmpeg-log"
				},
				{
					"match": "(?:^|\\s)([A-Za-z]:\\\\[^\\s,'\"<>]+)",
					"captures": { "1": { "name": "string.unquoted.path.ffmpeg-log" } }
				},
				{
					"match": "(?:^|\\s)(/[^\\s,'\"<>]+)",
					"captures": { "1": { "name": "string.unquoted.path.ffmpeg-log" } }
				},
				{
					"match": "\\b[^\\s'\"<>]+\\.(?:mp4|mov|m4v|m4a|mkv|webm|avi|flv|mp3|aac|wav|flac|ts|m2ts|srt|ass|vtt|jpg|jpeg|png|gif)\\b",
					"name": "string.unquoted.path.ffmpeg-log"
				}
			]
		},

		"hex": {
			"patterns": [
				{ "match": "\\b0x[0-9a-fA-F]+\\b", "name": "constant.numeric.hex.ffmpeg-log" },
				{
					"match": "\\b(?:avc1|hev1|hvc1|av01|vp09|mp4a|ac-3|ec-3|dtsc|opus|fLaC)\\b",
					"name": "constant.language.fourcc.ffmpeg-log"
				}
			]
		},

		"quoted": {
			"patterns": [
				{ "match": "\"([^\"\\\\]|\\\\.)*\"", "name": "string.quoted.double.ffmpeg-log" },
				{ "match": "'([^'\\\\]|\\\\.)*'", "name": "string.quoted.single.ffmpeg-log" }
			]
		},

		"fallback-kv": {
			"patterns": [
				{
					"match": "\\b([A-Za-z_][\\w.-]*)\\s*(:|=)\\s*",
					"captures": {
						"1": { "name": "variable.other.key.ffmpeg-log" },
						"2": { "name": "punctuation.separator.key-value.ffmpeg-log" }
					}
				}
			]
		},

		"percent": {
			"match": "(?<!\\w)\\d+(?:\\.\\d+)?%",
			"name": "constant.numeric.percentage.ffmpeg-log"
		},

		"numbers-soft": {
			"match": "\\b-?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?\\b",
			"name": "constant.numeric.ffmpeg-log"
		}
	}
}
